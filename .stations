
## Stations and coordinates
library(dplyr)

#List of stations and coordinates retrieved from database

StationQC

# Get rid of Na values
StationClean <- na.omit(StationQC)

#Create bin with coordinates range
bin_size <- 0.15

#Create list where coordinates are summarized in bins and the most frequent station names representing them.

StationClean <- StationClean %>%
  mutate(lat_bin = cut(latitude, breaks = seq(floor(min(latitude)), ceiling(max(latitude)), bin_size), include.lowest = TRUE),
         lon_bin = cut(longitude, breaks = seq(floor(min(longitude)), ceiling(max(longitude)), bin_size), include.lowest = TRUE))

grouped_Station <- StationClean %>%
  group_by(lat_bin, lon_bin) %>%
  summarise(stationName = names(sort(table(stationName), decreasing = TRUE)[1]),  # Keep the most frequent station name
            latitude = mean(latitude),
            longitude = mean(longitude))
